---
---

<section class="giscus-wrapper mt-8">
  <div class="giscus"></div>
</section>

<script is:inline data-astro-rerun>
  (function () {
    var container = document.querySelector(".giscus");
    if (!container) return;

    // Already loaded (e.g. bfcache restore)
    if (container.querySelector("iframe.giscus-frame")) return;

    container.innerHTML = "";

    var theme =
      document.documentElement.getAttribute("data-theme") === "dark"
        ? "dark"
        : "light";

    var s = document.createElement("script");
    s.src = "https://giscus.app/client.js";
    s.setAttribute("data-repo", "devkoriel/blog-koriel-kr");
    s.setAttribute("data-repo-id", "R_kgDORVH_1w");
    s.setAttribute("data-category", "General");
    s.setAttribute("data-category-id", "DIC_kwDORVH_184C247J");
    s.setAttribute("data-mapping", "pathname");
    s.setAttribute("data-strict", "0");
    s.setAttribute("data-reactions-enabled", "1");
    s.setAttribute("data-emit-metadata", "0");
    s.setAttribute("data-input-position", "top");
    s.setAttribute("data-theme", theme);
    s.setAttribute("data-lang", "en");
    s.crossOrigin = "anonymous";
    s.async = true;
    container.appendChild(s);
  })();

  // Theme sync observer â€” register once globally
  if (!window._giscusObs) {
    window._giscusObs = new MutationObserver(function () {
      var theme = document.documentElement.getAttribute("data-theme");
      var frame = document.querySelector("iframe.giscus-frame");
      if (frame) {
        frame.contentWindow.postMessage(
          { giscus: { setConfig: { theme: theme === "dark" ? "dark" : "light" } } },
          "https://giscus.app"
        );
      }
    });
    window._giscusObs.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ["data-theme"],
    });
  }
</script>
